<div style="width:100%;padding:10px;">
  <div style="text-align:end;border:1px solid;border-color:gainsboro;border-radius:.2rem">
    <div style="display: inline-block;text-align: left;width: 35%;font-size: 24px;vertical-align: middle;">PONUDA</div>
    <button type="button" class="btn btn-outline-primary" style="margin:3px;">Zaključi</button>
    <button type="button" class="btn btn-outline-primary" style="margin:3px;">Štampaj</button>
    <button type="button" class="btn btn-outline-primary" style="margin:3px;">E-mail</button>
    <button type="button" class="btn btn-outline-primary" style="margin:3px;">Kopiraj</button>
    <button type="button" class="btn btn-outline-primary" style="margin:3px;">Statusiraj</button>
    <button type="button" class="btn btn-outline-primary" style="margin:3px;">Obriši</button>
  </div>
  <div style="margin:10px">
    <div class="form-row form-group">
      <div class="col-sm-1"><label>Broj</label><input class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.broj" type="text" /></div>
      <div class="col-sm-2">
        <label>Datum</label><div class="input-group">
          <input class="form-control form-control-sm" placeholder="yyyy-mm-dd" name="dp" [(ngModel)]="selectedPonuda.datum" ngbDatepicker #d="ngbDatepicker">
          <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button"></button>
        </div>
      </div>
      <div class="col-sm-1"><label>Valuta</label><input class="form-control form-control-sm" [(ngModel)]="selectedPonuda.valuta_placanja" type="text" /></div>
      <div class="col-sm-1"><label>Opcija</label><input class="form-control form-control-sm" [(ngModel)]="selectedPonuda.rok_vazenja" type="text" /></div>
      <div class="col-sm-1"><label>Rok isporuke</label><input class="form-control form-control-sm" [(ngModel)]="selectedPonuda.rok_isporuke" type="text" /></div>
      <div class="col-sm-2"><label>Paritet</label><input class="form-control form-control-sm" [(ngModel)]="selectedPonuda.paritet" type="text" /></div>
    </div>
    <div class="form-row form-group" style="border-top: solid 1px gainsboro;padding-top: 10px;">
      <div class="col-sm-3"><label>Partner</label><input class="form-control form-control-sm" [(ngModel)]="selectedPonuda.partner_naziv" type="text" /></div>
      <div class="col-sm-3"><label>Adresa</label><input class="form-control form-control-sm" [(ngModel)]="selectedPonuda.partner_adresa" type="text" /></div>
      <div class="col-sm-2"><label>Izradio</label><input class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.radnik" type="text" /></div>
    </div>
    <div class="form-row form-group">
      <div class="col-sm-2"><label>Telefon</label><input class="form-control form-control-sm" [(ngModel)]="selectedPonuda.partner_telefon" type="text" /></div>
      <div class="col-sm-2"><label>Email</label><input class="form-control form-control-sm" [(ngModel)]="selectedPonuda.partner_email" type="text" /></div>
      <div class="col-sm-2"><label>JIB</label><input class="form-control form-control-sm" [(ngModel)]="selectedPonuda.partner_jib" type="text" /></div>
      <div class="col-sm-2"><label>Status</label><input class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.status" type="text" /></div>
    </div>
    <div class="form-row form-group">
      <div class="col-sm-8"><label>Napomena</label><input class="form-control form-control-sm" [(ngModel)]="selectedPonuda.predmet" type="text" /></div>
    </div>

  </div>


  <div style="margin:10px" *ngIf="selectedPonuda.stavke">
    <div>
      <!--<table class="table table-bordered" style="padding:5px;">
      <tr>
        <th> <label class="headerLabel">Naziv <br />Opis</label></th>
        <th> <label class="headerLabel">Količina JM</label></th>
        <th> <label class="headerLabel">Nabavna cijena</label></th>
        <th> <label class="headerLabel">Marža</label></th>
        <th> <label class="headerLabel">Cijena bez PDV-a</label></th>
        <th> <label class="headerLabel">Rabat</label></th>
        <th> <label class="headerLabel">Cijena sa rabatom</label></th>
        <th> <label class="headerLabel">PDV</label></th>
        <th> <label class="headerLabel">Cijena sa PDV-om</label></th>
        <th>-->
   

      <div *ngFor="let stavka of selectedPonuda.stavke" (dblclick)="startItemEdit(stavka)">
        <div class="form-row">
          <div class="col-sm-2">
            <textarea class="form-control form-control-sm" rows="2" *ngIf="stavka.editing" [(ngModel)]="stavka.artikal_naziv" type="text"></textarea>
            <div *ngIf="!stavka.editing">{{stavka.artikal_naziv}}</div>
          </div>
          <div class="col-sm-6">
            <textarea class="form-control form-control-sm" rows="2" *ngIf="stavka.editing" [(ngModel)]="stavka.opis"></textarea>
            <div *ngIf="!stavka.editing" style="">{{stavka.opis}}</div>
          </div>

        </div>
        <div class="form-row" style="border-bottom:solid 1px;border-color:gainsboro">


          <div class="col-sm-1">
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" [(ngModel)]="stavka.kolicina" (ngModelChange)="calculate()" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.kolicina}}</div>
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" [(ngModel)]="stavka.jedinica_mjere" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.jedinica_mjere}}</div>
          </div>

          <div class="col-sm-1">
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" [(ngModel)]="stavka.cijena_nabavna" (ngModelChange)="calculate()" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.cijena_nabavna | number : '1.2-2'}}</div>
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" disabled [ngModel]="stavka.vrijednost_nabavna  | number : '1.2-2'" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.vrijednost_nabavna | number : '1.2-2' }}</div>
          </div>

          <div class="col-sm-1">
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" [(ngModel)]="stavka.marza_procenat" (ngModelChange)="calculate()" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.marza_procenat | number : '1.2-2'}}</div>
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" disabled [ngModel]="stavka.ruc | number : '1.2-2'" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.ruc | number : '1.2-2'}}</div>
          </div>

          <div class="col-sm-1">
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" [(ngModel)]="stavka.cijena_bez_pdv" (ngModelChange)="calculate2()" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.cijena_bez_pdv | number : '1.2-2'}}</div>
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" disabled [ngModel]="stavka.iznos_bez_pdv | number : '1.2-2'" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.iznos_bez_pdv | number : '1.2-2'}}</div>
          </div>

          <div class="col-sm-1">
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" [(ngModel)]="stavka.rabat_procenat" (ngModelChange)="calculate3()" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.rabat_procenat| number : '1.2-2'}}</div>
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" disabled [ngModel]="stavka.rabat_iznos | number : '1.2-2'" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.rabat_iznos| number : '1.2-2'}}</div>
          </div>

          <div class="col-sm-1">
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" disabled [(ngModel)]="stavka.cijena_bez_pdv_sa_rabatom" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.cijena_bez_pdv_sa_rabatom| number : '1.2-2'}}</div>
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" disabled [ngModel]="stavka.iznos_bez_pdv_sa_rabatom | number : '1.2-2'" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.iznos_bez_pdv_sa_rabatom| number : '1.2-2'}}</div>
          </div>

          <div class="col-sm-1">
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" [(ngModel)]="stavka.pdv_stopa" (ngModelChange)="calculate4()" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.pdv_stopa| number : '1.2-2'}}</div>
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" disabled [ngModel]="stavka.pdv | number : '1.2-2'" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.pdv| number : '1.2-2'}}</div>
          </div>

          <div class="col-sm-1">
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" disabled [ngModel]="stavka.cijena_sa_pdv | number : '1.2-2'" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.cijena_sa_pdv | number : '1.2-2'}}</div>
            <input class="form-control form-control-sm" *ngIf="stavka.editing" style="text-align:right" disabled [ngModel]="stavka.iznos_sa_pdv | number : '1.2-2'" type="text" />
            <div *ngIf="!stavka.editing" style="text-align:right">{{stavka.iznos_sa_pdv| number : '1.2-2'}}</div>
          </div>
          <div class="col-sm-3">
            <button *ngIf="stavka.editing" (click)="save(stavka,false)" class="btn btn-outline-primary">S</button>
            <button *ngIf="stavka.editing&&itemAdd" (click)="save(stavka,true)" class="btn btn-outline-primary">SC</button><br *ngIf="stavka.editing" />
            <button *ngIf="stavka.editing" (click)="startItemEdit(stavka)" class="btn btn-outline-primary">E</button><br *ngIf="stavka.editing" />
            <button *ngIf="!stavka.editing" (click)="deleteStavka(stavka)" class="btn btn-outline-primary">X</button>
          </div>
        </div>
      </div>
    </div>
    <div class="form-row form-group" style="border-top: solid 1px gainsboro;padding-top: 10px;">
      <div class="col-sm-1"><label>Nab. vri.</label><input class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.nabavna_vrijednost" type="text" /></div>

      <div class="col-sm-1"><label>Nab. vri.</label><input style="text-align:right" class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.nabavna_vrijednost" type="text" /></div>
      <div class="col-sm-1"><label>RUC</label><inpu style="text-align:right" class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.ruc" type="text" /></div>
      <div class="col-sm-1"><label>Iz.bez rabata</label><input style="text-align:right" class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.iznos_bez_rabata" type="text" /></div>
      <div class="col-sm-1"><label>Rabat</label><input style="text-align:right" class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.rabat" type="text" /></div>
      <div class="col-sm-1"><label>Iz. sa rabatom</label><input style="text-align:right" class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.iznos_sa_rabatom" type="text" /></div>
      <div class="col-sm-1"><label>PDV</label><input style="text-align:right" class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.pdv" type="text" /></div>
      <div class="col-sm-1"><label>Iz. sa PDV-om</label><input style="text-align:right" class="form-control form-control-sm" disabled [(ngModel)]="selectedPonuda.iznos_sa_pdv" type="text" /></div>
    </div>
  </div>
  <div style="text-align:end;border:1px solid;border-color:gainsboro;border-radius:.2rem">
    <button type="button" [disabled]="itemAdd==true"  class="btn btn-outline-success" style="margin:3px;" (click)="startItemAdd()">Unos stavki</button>
    <button type="button" class="btn btn-outline-success" style="margin:3px;" (click)="savePonuda(selectedPonuda)">Sačuvaj</button>
    <button type="button" class="btn btn-outline-warning" style="margin:3px;" (click)="cancel()">Odustani</button>
  </div>
</div>
